{% extends "base.html" %}

{% block title %}Plan Your Trip{% endblock %}

{% block extra_head %}
<style>
  .form-section {
    max-width: 720px;
    margin: 3rem auto;
    background-color: #ffffff;
    padding: 2rem 2.5rem;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }

  .form-section h2 {
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
    color: #0d6efd;
  }

  .btn-submit {
    width: 100%;
    padding: 0.75rem;
    font-size: 1.1rem;
    border-radius: 8px;
  }

  .trip-card {
    background-color: #f8f9fa;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    margin-bottom: 1.5rem;
    overflow: hidden;
    transition: transform 0.2s ease;
  }

  .trip-card:hover {
    transform: scale(1.01);
  }

  .trip-image {
    object-fit: cover;
    width: 100%;
    height: 100%;
    border-radius: 12px 0 0 12px;
  }

  .trip-info {
    padding: 1rem 1.5rem;
  }

  .trip-title {
    color: #212529;
    font-size: 1.4rem;
    font-weight: 600;
  }

  .trip-meta {
    font-size: 0.95rem;
    color: #495057;
  }

  .no-trips {
    text-align: center;
    color: #dc3545;
    font-weight: bold;
    margin-top: 2rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <div class="form-section">
    <h2>Plan Your Trip</h2>
    <form method="POST">
      {% csrf_token %}
      {{ form.non_field_errors }}
      <div class="mb-3">
        <label for="{{ form.start_destination.id_for_label }}" class="form-label">Start Destination</label>
        {{ form.start_destination }}
      </div>
      <div class="mb-3">
        <label for="{{ form.end_destination.id_for_label }}" class="form-label">End Destination</label>
        {{ form.end_destination }}
      </div>
      <div class="mb-3">
        <label for="{{ form.start_date.id_for_label }}" class="form-label">Start Date</label>
        {{ form.start_date }}
      </div>
      <div class="mb-3">
        <label for="{{ form.end_date.id_for_label }}" class="form-label">End Date</label>
        {{ form.end_date }}
      </div>
      <div class="mb-3">
        <label for="{{ form.number_of_people.id_for_label }}" class="form-label">Number of People</label>
        {{ form.number_of_people }}
      </div>
      <button type="submit" name="search" class="btn btn-primary btn-submit">
        <i class="bi bi-search me-2"></i>Search Trips
      </button>
    </form>
  </div>

  {% if no_trips %}
    <div class="no-trips">No trips available for selected categories</div>
  {% endif %}

  {% if available_trips %}
    <div class="mt-5">
      <h4 class="text-center mb-4">Available Trips</h4>
      <div class="row row-cols-1 row-cols-md-2 g-4">
        {% for trip in available_trips %}
          <div class="col">
            <div class="trip-card d-flex flex-column flex-md-row">
              {% if trip.picture_url %}
                <div class="col-md-5">
                  <img src="{{ trip.picture_url }}" alt="{{ trip.name }}" class="trip-image w-100 h-100">
                </div>
              {% endif %}
              <div class="trip-info col">
                <h5 class="trip-title">{{ trip.name }}</h5>
                <p class="trip-meta">{{ trip.description }}</p>
                <p class="trip-meta mb-1"><i class="bi bi-geo-alt me-1"></i>{{ trip.start_destination }} → {{ trip.end_destination }}</p>
                <p class="trip-meta mb-1"><i class="bi bi-calendar-event me-1"></i>{{ trip.start_date }} to {{ trip.end_date }}</p>
                <p class="trip-meta mb-3"><i class="bi bi-people me-1"></i>{{ trip.number_of_people }} people · <strong>${{ trip.price }}</strong></p>
                <form method="POST">
                  {% csrf_token %}
                  <input type="hidden" name="book_trip_id" value="{{ trip.id }}">
                  <button type="submit" class="btn btn-success w-100">
                    <i class="bi bi-check2-circle me-1"></i>Book Now
                  </button>
                </form>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
